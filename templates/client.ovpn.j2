client

proto {{openvpn_proto}}
remote {{ansible_default_ipv4.interface}} {{openvpn_port}}
dev tun
resolv-retry {{ openvpn_resolv_retry }}
nobind
persist-key
persist-tun
remote-cert-tls server
auth SHA256
auth-nocache
cipher AES-256-CBC
tls-client
{% if openvpn_use_modern_tls %}
tls-version-min 1.2
{% endif %}
setenv opt block-outside-dns
keepalive 5 30
compress lzo
verb 3

{# route-delay 2
{% if openvpn_client_register_dns %}
register-dns
{% endif %}#}

key-direction 1 
<ca>
{{ ca_cert.content|b64decode }}
</ca>

<tls-auth>
{{ tls_auth.content|b64decode }}
</tls-auth>

<cert>
{{ item.0.content|b64decode }}
</cert>

<key>
{{ item.1.content|b64decode }}
</key>

{% if openvpn_verify_cn|bool %}
verify-x509-name OpenVPN-Server-{{inventory_hostname[:49]}} name
{% endif %}
